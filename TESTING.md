# Руководство по тестированию

## Обзор

Этот документ описывает процесс тестирования приложения для генерации описаний картин.

## Типы тестов

### 1. Валидация изображений

#### Тест 1: Загрузка различных форматов
- **Цель**: Проверить, что приложение принимает только допустимые форматы
- **Шаги**:
  1. Попробуйте загрузить файлы разных форматов:
     - ✅ JPEG (.jpg, .jpeg)
     - ✅ PNG (.png)
     - ✅ WebP (.webp)
     - ✅ GIF (.gif)
     - ❌ PDF (.pdf)
     - ❌ TXT (.txt)
     - ❌ DOC (.doc)
- **Ожидаемый результат**: Только изображения должны быть приняты, остальные должны показать ошибку

#### Тест 2: Проверка размера файлов
- **Цель**: Проверить ограничение размера файлов
- **Шаги**:
  1. Загрузите файл размером менее 10 MB - должен быть принят
  2. Загрузите файл размером более 10 MB - должна быть ошибка
- **Ожидаемый результат**: Файлы больше 10 MB отклоняются с понятным сообщением

#### Тест 3: Проверка количества файлов
- **Цель**: Проверить ограничение количества файлов
- **Шаги**:
  1. Загрузите 10 файлов - должны быть приняты
  2. Загрузите 11 файлов - должна быть ошибка
- **Ожидаемый результат**: Максимум 10 файлов, остальные отклоняются

### 2. Генерация описаний

#### Тест 1: Генерация описаний для одной картины
- **Цель**: Проверить базовую функциональность
- **Шаги**:
  1. Загрузите одно изображение
  2. Нажмите кнопку "Описание"
  3. Дождитесь результата
- **Ожидаемый результат**: 
  - Показывается индикатор загрузки
  - Генерируется описание картины
  - Описание содержит информацию о стиле, композиции, цветах

#### Тест 2: Генерация описаний для нескольких картин
- **Цель**: Проверить обработку множественных изображений
- **Шаги**:
  1. Загрузите 3-5 изображений
  2. Нажмите кнопку "Описание"
  3. Дождитесь результата
- **Ожидаемый результат**:
  - Показывается прогресс обработки
  - Генерируются описания для всех картин
  - Каждое описание привязано к своему файлу

#### Тест 3: Различные типы картин
- **Цель**: Проверить работу с разными стилями
- **Шаги**:
  1. Загрузите картины разных стилей:
     - Реализм
     - Абстракция
     - Портрет
     - Пейзаж
  2. Сгенерируйте описания
- **Ожидаемый результат**: Описания отражают особенности каждого стиля

### 3. Генерация названий выставки

#### Тест 1: Генерация вариантов названий
- **Цель**: Проверить генерацию 3 вариантов
- **Шаги**:
  1. Сгенерируйте описания для нескольких картин
  2. Нажмите кнопку "Выставка"
  3. Дождитесь результата
- **Ожидаемый результат**:
  - Генерируются 3 варианта названий
  - Названия отражают общую тематику выставки
  - Названия на русском языке

#### Тест 2: Выбор варианта названия
- **Цель**: Проверить выбор варианта
- **Шаги**:
  1. Сгенерируйте варианты названий
  2. Кликните на один из вариантов
- **Ожидаемый результат**:
  - Выбранный вариант визуально выделяется
  - Показывается подтверждение выбора

#### Тест 3: Без описаний
- **Цель**: Проверить валидацию
- **Шаги**:
  1. Загрузите изображения
  2. Попробуйте нажать "Выставка" без генерации описаний
- **Ожидаемый результат**: Показывается ошибка с инструкцией

### 4. Генерация афиши

#### Тест 1: Генерация афиши
- **Цель**: Проверить полный цикл
- **Шаги**:
  1. Сгенерируйте описания
  2. Выберите вариант названия выставки
  3. Нажмите кнопку "Афиша"
  4. Дождитесь результата
- **Ожидаемый результат**:
  - Генерируется макет афиши (текстовое описание)
  - Генерируется краткое описание выставки
  - Оба элемента отображаются раздельно

#### Тест 2: Без выбранного названия
- **Цель**: Проверить валидацию
- **Шаги**:
  1. Сгенерируйте описания и варианты названий
  2. Попробуйте нажать "Афиша" без выбора названия
- **Ожидаемый результат**: Показывается ошибка с инструкцией

### 5. Обработка ошибок

#### Тест 1: Ошибка сети
- **Цель**: Проверить обработку сетевых ошибок
- **Шаги**:
  1. Отключите интернет
  2. Попробуйте сгенерировать описания
- **Ожидаемый результат**: Показывается понятное сообщение об ошибке сети

#### Тест 2: Таймаут
- **Цель**: Проверить обработку таймаутов
- **Шаги**:
  1. Загрузите очень много больших изображений
  2. Попробуйте сгенерировать описания
- **Ожидаемый результат**: При таймауте показывается соответствующее сообщение

#### Тест 3: Retry механизм
- **Цель**: Проверить автоматические повторы
- **Шаги**:
  1. Временно отключите интернет
  2. Начните генерацию описаний
  3. Включите интернет во время попытки
- **Ожидаемый результат**: Запрос автоматически повторяется

#### Тест 4: Отмена запроса
- **Цель**: Проверить отмену запросов
- **Шаги**:
  1. Начните генерацию описаний
  2. Нажмите кнопку "Отменить"
- **Ожидаемый результат**: Запрос отменяется, показывается соответствующее сообщение

### 6. Оптимизация

#### Тест 1: Оптимизация изображений
- **Цель**: Проверить сжатие и ресайз
- **Шаги**:
  1. Загрузите большое изображение (например, 5 MB, 4000x3000)
  2. Проверьте размер после оптимизации
- **Ожидаемый результат**:
  - Показывается индикатор оптимизации
  - Размер файла уменьшается
  - Разрешение уменьшается до максимум 1920x1920

#### Тест 2: Кэширование
- **Цель**: Проверить работу кэша
- **Шаги**:
  1. Сгенерируйте описания для набора изображений
  2. Повторно сгенерируйте описания для тех же изображений
- **Ожидаемый результат**: Второй запрос выполняется мгновенно, используется кэш

#### Тест 3: Дебаунсинг
- **Цель**: Проверить предотвращение множественных кликов
- **Шаги**:
  1. Быстро кликните на кнопку "Описание" несколько раз
- **Ожидаемый результат**: Выполняется только один запрос

### 7. Граничные случаи

#### Тест 1: Максимальное количество файлов
- **Цель**: Проверить работу с 10 файлами
- **Шаги**:
  1. Загрузите 10 изображений
  2. Сгенерируйте описания
- **Ожидаемый результат**: Все файлы обрабатываются корректно

#### Тест 2: Большие файлы
- **Цель**: Проверить работу с файлами близкими к лимиту
- **Шаги**:
  1. Загрузите файл размером 9.9 MB
  2. Сгенерируйте описание
- **Ожидаемый результат**: Файл обрабатывается, но может занять больше времени

#### Тест 3: Разные форматы в одном наборе
- **Цель**: Проверить смешанные форматы
- **Шаги**:
  1. Загрузите набор: JPEG, PNG, WebP, GIF
  2. Сгенерируйте описания
- **Ожидаемый результат**: Все форматы обрабатываются корректно

#### Тест 4: Пустой результат
- **Цель**: Проверить обработку пустых ответов
- **Шаги**:
  1. Попробуйте сгенерировать описания без изображений
- **Ожидаемый результат**: Показывается ошибка валидации

## Автоматические тесты

Для запуска автоматических тестов:

```powershell
npm test
```

Тесты находятся в директории `__tests__/`:
- `validation.test.ts` - тесты валидации изображений
- `cache.test.ts` - тесты системы кэширования

## Чек-лист для ручного тестирования

- [ ] Загрузка различных форматов изображений
- [ ] Валидация размера файлов
- [ ] Валидация количества файлов
- [ ] Генерация описаний для одной картины
- [ ] Генерация описаний для нескольких картин
- [ ] Генерация вариантов названий выставки
- [ ] Выбор варианта названия
- [ ] Генерация афиши
- [ ] Обработка ошибок сети
- [ ] Обработка таймаутов
- [ ] Retry механизм
- [ ] Отмена запросов
- [ ] Оптимизация изображений
- [ ] Кэширование результатов
- [ ] Дебаунсинг кнопок
- [ ] Граничные случаи

## Известные ограничения

1. Тесты требуют реального API ключа OpenRouter
2. Некоторые тесты требуют реальных изображений
3. Тесты производительности могут зависеть от скорости интернета

## Рекомендации

1. Всегда тестируйте с реальными изображениями перед деплоем
2. Проверяйте работу на разных браузерах
3. Тестируйте на разных размерах экранов
4. Проверяйте работу с медленным интернетом
